package org.exploit.keeper.service.nonce

import jakarta.inject.Singleton
import org.exploit.keeper.util.temporary.InMemoryTemporaryMap
import java.util.concurrent.TimeUnit

@Singleton
class InMemoryNonceStore: NonceStore {
    private val store = InMemoryTemporaryMap<String, Boolean>(NonceStore.LIVE_TIME_SECONDS, TimeUnit.SECONDS)

    override fun rememberIfNew(nonce: String): Boolean {
        return store.put(nonce, true)
    }
}