package org.exploit.keeper.service.signature.gg20

import org.exploit.gmp.BigInt
import org.exploit.keeper.model.common.Value
import org.exploit.tss.curve.ec.WeierstrassPointOps

class GG20SignaturePartHandler<P : WeierstrassPointOps<P>>(
    private val peerId: Int,
    private val factory: GG20SessionManager<P>
) {
    fun computePartialS(sessionId: String, finalize: Boolean = false): Value<BigInt> {
        val result = factory.session(sessionId)
            .client
            .signature()
            .computePartialS()
            .let { Value(peerId, it) }

        if (finalize)
            factory.clear(sessionId)

        return result
    }
}