package org.exploit.keeper.service.signature.instance

import io.quarkus.arc.All
import jakarta.inject.Singleton
import org.exploit.keeper.constant.CurveName
import org.exploit.keeper.constant.SessionType

@Singleton
class SessionManagerResolver(
    @All
    private val instances: MutableList<SessionManagerInstance>
) {
    fun findManager(type: SessionType, curve: CurveName): SessionManagerInstance? {
        return instances.find { it.session() == type && it.curve() == curve }
    }

    fun findBySessionId(type: SessionType, sessionId: String) : SessionManagerInstance? {
        return instances.find { it.session() == type && it.hasSessionId(sessionId) }
    }
}