package org.exploit.keeper.service.signature

import org.exploit.keeper.constant.crypto.CurveName
import org.exploit.keeper.constant.crypto.SessionType
import org.exploit.keeper.model.RawPublicKeyDto
import org.exploit.tss.curve.PointOps

interface ThresholdSessionFactory<T, P: PointOps<P>> {
    fun createSession(
        sessionId: String, keyId: String, operations: Map<String, ByteArray>,
        publicKey: RawPublicKeyDto, participants: List<Int>, context: ByteArray
    ): T

    fun session(sessionId: String): T

    fun clear(sessionId: String)

    fun type(): SessionType

    fun supportsCurve(curveName: CurveName): Boolean
}