package org.exploit.keeper.service.signature

import org.exploit.keeper.constant.CurveName
import org.exploit.keeper.constant.SessionType
import org.exploit.keeper.model.Operations
import org.exploit.keeper.model.PublicKeyDto
import org.exploit.tss.curve.PointOps

interface ThresholdSessionFactory<T, P: PointOps<P>> {
    fun createSession(
        sessionId: String, keyId: String, operations: Operations,
        publicKey: PublicKeyDto, participants: List<Int>
    ): T

    fun session(sessionId: String): T

    fun clear(sessionId: String)

    fun type(): SessionType

    fun supportsCurve(curveName: CurveName): Boolean
}