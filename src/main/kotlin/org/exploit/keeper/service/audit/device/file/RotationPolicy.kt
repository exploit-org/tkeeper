package org.exploit.keeper.service.audit.device.file

import java.time.Duration
import java.time.Instant

class RotationPolicy(
    private val maxBytes: Long,
    private val rollEvery: Duration?
) {
    fun shouldRoll(bytesWritten: Long, createdAt: Instant, now: Instant): Boolean {
        if (bytesWritten >= maxBytes)
            return true

        if (rollEvery != null && createdAt.plus(rollEvery) <= now)
            return true

        return false
    }
}