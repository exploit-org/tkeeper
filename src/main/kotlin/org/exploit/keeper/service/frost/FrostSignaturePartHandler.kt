package org.exploit.keeper.service.frost

import jakarta.inject.Singleton
import org.exploit.keeper.config.KeeperConfig
import org.exploit.keeper.model.common.Value
import java.math.BigInteger

@Singleton
class FrostSignaturePartHandler(
    private val config: KeeperConfig,
    private val sessionFactory: FrostSessionFactory
) {
    fun computeZ(sessionId: String): Value<BigInteger> {
        val session = sessionFactory.session(sessionId)
        return Value(config.idx(), session.client.signature().computeZ())
    }
}