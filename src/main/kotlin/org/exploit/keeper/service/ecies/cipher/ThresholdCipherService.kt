package org.exploit.keeper.service.ecies.cipher

import org.exploit.ecies.model.CipherText
import org.exploit.keeper.constant.CipherType
import org.exploit.keeper.constant.CurveName
import org.exploit.keeper.model.ecies.PartiallyDecrypted
import reactor.core.publisher.Mono

interface ThresholdCipherService {
    fun curveName(): CurveName

    fun encrypt(keyId: String, cipherType: CipherType, plaintext: ByteArray): Mono<CipherText>

    fun decrypt(keyId: String, cipherType: CipherType, ciphertext: ByteArray): Mono<ByteArray>

    fun partialDecrypt(keyId: String, cipherType: CipherType, ciphertext: ByteArray, participants: List<Int>): PartiallyDecrypted
}