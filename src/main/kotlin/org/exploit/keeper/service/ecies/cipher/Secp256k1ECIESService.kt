package org.exploit.keeper.service.ecies.cipher

import jakarta.inject.Singleton
import org.exploit.keeper.constant.crypto.KeeperCurve
import org.exploit.keeper.db.RocksKeyDB
import org.exploit.keeper.service.client.TKeeperClients
import org.exploit.keeper.service.ecies.client.Secp256k1ECIESClientFactory
import org.exploit.keeper.service.ecies.client.ThresholdECIESClientFactory
import org.exploit.keeper.service.pub.PublicKeyService
import org.exploit.keeper.service.pub.commits.KeeperCommitmentService
import org.exploit.secp256k1.Secp256k1PointOps
import org.exploit.signalix.manager.EventScope

@Singleton
class Secp256k1ECIESService(
    commitments: KeeperCommitmentService,
    db: RocksKeyDB, clients: TKeeperClients,
    publicKeyService: PublicKeyService, eventScope: EventScope,
    private val factory: Secp256k1ECIESClientFactory
): ThresholdECIESService<Secp256k1PointOps>(commitments, db, clients, publicKeyService, eventScope) {
    override fun curve(): KeeperCurve<Secp256k1PointOps> = KeeperCurve.SECP256K1

    override fun factory(): ThresholdECIESClientFactory<Secp256k1PointOps> = factory
}