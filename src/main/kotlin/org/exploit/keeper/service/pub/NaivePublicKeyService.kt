package org.exploit.keeper.service.pub

import jakarta.inject.Singleton
import jakarta.ws.rs.NotFoundException
import org.exploit.keeper.db.LMKDB
import org.exploit.keeper.extension.toBase64
import org.exploit.keeper.model.PublicKeyDto

@Singleton
class NaivePublicKeyService(private val db: LMKDB): PublicKeyService {
    override fun getPublicKey(keyId: String): PublicKeyDto {
        return db.public.get(keyId)?.let { PublicKeyDto(it.toBase64()) } ?: throw NotFoundException()
    }
}