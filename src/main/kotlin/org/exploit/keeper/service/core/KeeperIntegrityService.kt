package org.exploit.keeper.service.core

import jakarta.inject.Singleton
import org.exploit.keeper.db.RocksKeyDB
import org.exploit.keeper.model.RawPublicKeyDto

@Singleton
class KeeperIntegrityService(
    private val db: RocksKeyDB,
    private val keeper: KeeperInitService
) {
    fun integrityKey(): RawPublicKeyDto {
        keeper.ensureReady()

        return RawPublicKeyDto(db.getIntegrityKey().encoded())
    }

    fun regenerateIntegrityKey() {
        keeper.ensureReady()

        db.writeIntegrityKey()
    }
}