package org.exploit.keeper.service.core.seal.provider

import org.exploit.keeper.exception.SealedException
import org.exploit.keeper.model.seal.init.SealInitData
import org.exploit.keeper.model.seal.progress.Progress
import org.exploit.keeper.service.key.kek.KekOps

interface SealProvider {
    val id: String

    fun kekOpsOrNull(): KekOps?

    fun kekOps(): KekOps = kekOpsOrNull() ?: throw SealedException()

    fun initialize(): SealInitData

    fun initialProgress(): Progress

    fun unseal(): Progress

    fun currentProgress(): Progress

    fun seal()
}