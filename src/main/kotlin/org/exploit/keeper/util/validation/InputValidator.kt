package org.exploit.keeper.util.validation

object InputValidator {
    private val badChars = Regex("[\\p{Cc}\\p{Cf}\\p{Cs}]")
    private val keyIdRegex = Regex("^[a-z0-9]+(?:-[a-z0-9]+)*(?::[a-z0-9]+(?:-[a-z0-9]+)*)?$")
    private val tweakRegex = Regex("^[a-z0-9:_\\-/]{1,255}$")

    fun isValidKeyId(keyId: String): Boolean {
        if (keyId.isEmpty() || keyId.length > 255) return false

        return keyIdRegex.matches(keyId)
    }

    fun isValidAssetOwner(owner: String): Boolean {
        if (owner.isEmpty()) return false
        if (owner.length > 255) return false

        return !badChars.containsMatchIn(owner)
    }

    fun isValidTweak(tweak: String): Boolean {
        if (tweak.isEmpty() || tweak.length > 255) return false
        return tweakRegex.matches(tweak)
    }
}