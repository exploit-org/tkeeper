package org.exploit.keeper.controller.store

import jakarta.ws.rs.Consumes
import jakarta.ws.rs.POST
import jakarta.ws.rs.Path
import jakarta.ws.rs.QueryParam
import org.exploit.keeper.model.keygen.StoreRaw
import org.exploit.keeper.provider.MessagePackProvider
import org.exploit.keeper.service.core.KeeperStorageService

@Path("/v1/storage")
class InternalKeyStoreController(private val storage: KeeperStorageService) {
    @POST
    @Path("/store")
    @Consumes(MessagePackProvider.MSGPACK_MIME)
    fun store(body: StoreRaw) {
        storage.storeShare(body)
    }

    @POST
    @Path("/revert")
    fun revert(@QueryParam("keyId") keyId: String) {
        storage.deleteShare(keyId)
    }
}