package org.exploit.keeper.controller.keygen

import io.smallrye.mutiny.Uni
import jakarta.ws.rs.POST
import jakarta.ws.rs.Path
import org.exploit.keeper.constant.KeeperCurve
import org.exploit.keeper.model.request.Generate
import org.exploit.keeper.service.keygen.starter.DKGenerator

@Path("/v1/keeper/dkg")
class KeyGenController(private val dkg: DKGenerator) {
    @POST
    @Path("/generate")
    fun generate(body: Generate): Uni<Void> {
        return dkg.generateKey(
            keyId = body.keyId,
            curve = KeeperCurve.fromName(body.curve),
            overwrite = body.overwrite
        )
    }
}