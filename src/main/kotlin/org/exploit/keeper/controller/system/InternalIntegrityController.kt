package org.exploit.keeper.controller.system

import jakarta.ws.rs.GET
import jakarta.ws.rs.Path
import jakarta.ws.rs.Produces
import org.exploit.keeper.model.RawPublicKeyDto
import org.exploit.keeper.provider.MessagePackProvider
import org.exploit.keeper.service.core.KeeperIntegrityService

@Path("/v1/integrity")
class InternalIntegrityController(private val integrity: KeeperIntegrityService) {
    @GET
    @Path("/publicKey")
    @Produces(MessagePackProvider.MSGPACK_MIME)
    fun integrity(): RawPublicKeyDto = integrity.integrityKey()
}