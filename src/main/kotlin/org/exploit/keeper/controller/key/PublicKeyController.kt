package org.exploit.keeper.controller.key

import jakarta.validation.constraints.NotNull
import jakarta.ws.rs.GET
import jakarta.ws.rs.Path
import org.exploit.keeper.extension.toBase64
import org.exploit.keeper.model.PublicKeyDto
import org.exploit.keeper.service.pub.share.PublicKeyShareCalculator

@Path("/v1/publicKey")
class PublicKeyController(private val pubShare: PublicKeyShareCalculator) {
    @GET
    @Path("/{keyId}")
    fun getPublicKey(@NotNull keyId: String): PublicKeyDto =
        PublicKeyDto(pubShare.pubKeyShare(keyId).share.encode(true).toBase64())
}