package org.exploit.keeper.controller.key

import jakarta.validation.constraints.NotNull
import jakarta.ws.rs.GET
import jakarta.ws.rs.Path
import jakarta.ws.rs.Produces
import org.exploit.keeper.model.RawPublicKeyDto
import org.exploit.keeper.provider.MessagePackProvider
import org.exploit.keeper.service.pub.share.PublicKeyShareCalculator

@Path("/v1/publicKey")
class InternalPublicKeyController(private val pubShare: PublicKeyShareCalculator) {
    @GET
    @Path("/{keyId}")
    @Produces(MessagePackProvider.MSGPACK_MIME)
    fun getPublicKey(@NotNull keyId: String): RawPublicKeyDto =
        RawPublicKeyDto(pubShare.pubKeyShare(keyId).share.encode(true))
}