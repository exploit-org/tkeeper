package org.exploit.keeper.config.audit

data class AuditSocketConfig(
    val host: String = "localhost",
    val port: Int = 443,
    val connectTimeoutMillis: Int = 2000,
    val readTimeoutMillis: Int = 2000,
    val tcpNoDelay: Boolean = true,
    val keepAlive: Boolean = true,
    val soLingerSeconds: Int = 0,
    val tls: TlsConfig? = null,
) {
    data class TlsConfig(
        val protocols: List<String> = listOf("TLSv1.3", "TLSv1.2"),
        val verifyHostname: Boolean = true,
        val trust: TrustConfig? = null,
        val spkiPins: List<String>? = null,
        val client: ClientConfig? = null,
    )

    data class TrustConfig(
        val mode: String = "system",
        val path: String? = null,
        val password: String? = null,
        val type: String = "JKS",
    )

    data class ClientConfig(
        val keystorePath: String? = null,
        val keystorePassword: String? = null,
        val keystoreType: String = "PKCS12",
    )
}