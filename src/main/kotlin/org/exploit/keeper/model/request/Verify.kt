package org.exploit.keeper.model.request

import org.exploit.keeper.constant.crypto.SignatureType
import org.exploit.keeper.model.audit.ctx.Crypto
import org.exploit.keeper.model.capability.HasCryptoContext
import org.exploit.keeper.model.capability.HasKeyId
import org.exploit.keeper.model.capability.HasTweak
import org.exploit.keeper.model.signature.SignatureContext

data class Verify(
    override val keyId: String = "",
    val sigType: SignatureType,
    val data64: String = "",
    val signature64: String = "",
    val context: SignatureContext? = null,
    val generation: Int? = null,
    val hash: Boolean = false,
    override val tweak: String? = null
): HasKeyId, HasCryptoContext, HasTweak {
    override fun crypto(): Crypto {
        return Crypto(
            kid = keyId
        )
    }
}