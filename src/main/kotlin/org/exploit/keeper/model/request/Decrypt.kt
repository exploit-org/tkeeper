package org.exploit.keeper.model.request

import org.exploit.keeper.constant.cipher.CipherType
import org.exploit.keeper.model.audit.ctx.Crypto
import org.exploit.keeper.model.capability.HasAlgorithm
import org.exploit.keeper.model.capability.HasCryptoContext
import org.exploit.keeper.model.capability.HasKeyId
import org.exploit.keeper.model.capability.HasTweak

data class Decrypt(
    override val keyId: String,
    override val algorithm: CipherType = CipherType.AES_GCM,
    val ciphertext64: String,
    val generation: Int? = null,
    override val tweak: String? = null,
): HasKeyId, HasAlgorithm<CipherType>, HasCryptoContext, HasTweak {
    override fun crypto(): Crypto {
        return Crypto(
            algo = algorithm.name,
            kid = keyId,
            generation = generation
        )
    }
}