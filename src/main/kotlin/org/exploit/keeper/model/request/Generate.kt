package org.exploit.keeper.model.request

import org.exploit.keeper.constant.crypto.CurveName
import org.exploit.keeper.constant.dkg.KeyGenMode
import org.exploit.keeper.model.audit.ctx.Crypto
import org.exploit.keeper.model.capability.HasCryptoContext
import org.exploit.keeper.model.capability.HasCurve
import org.exploit.keeper.model.capability.HasKeyId
import org.exploit.keeper.model.keyset.KeySetPolicy

data class Generate(
    override val keyId: String,
    override val curve: CurveName,
    val mode: KeyGenMode,
    val policy: KeySetPolicy? = null,
    val assetOwner: String? = null
): HasKeyId, HasCurve, HasCryptoContext {
    override fun crypto(): Crypto {
        return Crypto(
            kid = keyId,
            curve = curve
        )
    }
}