package org.exploit.keeper.model.request

import org.exploit.keeper.constant.crypto.SessionType
import org.exploit.keeper.model.audit.ctx.Crypto
import org.exploit.keeper.model.capability.HasAlgorithm
import org.exploit.keeper.model.capability.HasCryptoContext
import org.exploit.keeper.model.capability.HasKeyId
import org.exploit.keeper.model.common.OperationsDto
import org.exploit.keeper.model.signature.SignatureContext

data class Sign(
    override val keyId: String,
    override val algorithm: SessionType,
    val operations: OperationsDto,
    val context: SignatureContext? = null,
    val hash: Boolean = false
): HasKeyId, HasAlgorithm<SessionType>, HasCryptoContext {
    override fun crypto(): Crypto {
        return Crypto(
            algo = algorithm.name,
            kid = keyId
        )
    }
}