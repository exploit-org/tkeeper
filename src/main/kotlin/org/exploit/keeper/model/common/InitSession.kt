package org.exploit.keeper.model.common

import org.exploit.keeper.constant.crypto.CurveName
import org.exploit.keeper.model.RawPublicKeyDto
import org.exploit.keeper.model.audit.ctx.Crypto
import org.exploit.keeper.model.capability.HasCryptoContext
import org.exploit.keeper.model.capability.HasCurve
import org.exploit.keeper.model.capability.HasKeyId
import org.exploit.keeper.model.capability.HasSessionId
import org.exploit.keeper.model.signature.SignatureContext

class InitSession(
    override val sessionId: String = "",
    override val keyId: String = "",
    override val curve: CurveName = CurveName.SECP256K1,

    val operations: Map<String, ByteArray> = emptyMap(),
    val publicKey: RawPublicKeyDto = RawPublicKeyDto(),
    val participants: List<Int> = emptyList(),
    val additionalContext: ByteArray = ByteArray(0),
    val context: SignatureContext?,
    val tweak: String?
): HasSessionId, HasKeyId, HasCurve, HasCryptoContext {
    override fun crypto(): Crypto {
        return Crypto(kid = keyId, curve = curve)
    }
}