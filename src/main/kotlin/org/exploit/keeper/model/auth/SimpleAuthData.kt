package org.exploit.keeper.model.auth

import org.exploit.keeper.permission.AntPermission

data class SimpleAuthData(override val subject: String, val permissions: List<String> = emptyList()): AuthData {
    private val antPermissions by lazy {
        permissions.map { AntPermission.of(it) }
    }

    override fun hasPermission(permission: String): Boolean =
        antPermissions.any { it.matches(permission) } && antPermissions.none { it.matches("-$permission") }
}