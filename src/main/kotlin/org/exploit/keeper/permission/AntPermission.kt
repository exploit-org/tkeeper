package org.exploit.keeper.permission

import org.exploit.keeper.util.cache.LRUCache

class AntPermission(pattern: String, cacheSize: Int = 128) {
    private val matcher = AntPermissionMatcher(pattern)
    private val cache: LRUCache<String, Boolean> = LRUCache(cacheSize)

    fun matches(path: String): Boolean {
        return cache.computeIfAbsent(path) { permission -> matcher.match(permission) }
    }

    companion object {
        fun of(path: String): AntPermission {
            return AntPermission(path)
        }
    }
}