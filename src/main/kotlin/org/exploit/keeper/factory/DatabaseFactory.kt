package org.exploit.keeper.factory

import io.micronaut.context.annotation.Factory
import jakarta.inject.Singleton
import org.exploit.keeper.config.keeper.KeeperConfig
import org.exploit.keeper.db.RocksKeyDB
import java.nio.file.Files
import java.nio.file.Paths

@Factory
class DatabaseFactory(private val config: KeeperConfig) {
    @Singleton
    fun rocksdb(): RocksKeyDB {
        val path = Paths.get(config.databasePath)

        if (!Files.exists(path))
            Files.createDirectories(path)

        return RocksKeyDB(config.databasePath)
    }
}