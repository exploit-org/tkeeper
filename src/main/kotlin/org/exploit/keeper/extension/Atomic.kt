package org.exploit.keeper.extension

import java.util.concurrent.atomic.AtomicReference

fun <T : Any> AtomicReference<T>.getOrSet(initializer: () -> T): T {
    val current = get()

    if (current != null)
        return current

    val created = initializer()
    val prev = compareAndExchange(null, created)

    return prev ?: created
}