package org.exploit.keeper.extension

import com.fasterxml.jackson.databind.ObjectMapper
import com.fasterxml.jackson.databind.module.SimpleModule
import com.fasterxml.jackson.module.kotlin.jacksonObjectMapper
import com.fasterxml.jackson.module.kotlin.registerKotlinModule
import org.exploit.gmp.BigInt
import org.exploit.keeper.component.JacksonCustomizer
import org.msgpack.jackson.dataformat.MessagePackMapper

val messagePackMapper: ObjectMapper = MessagePackMapper().registerKotlinModule()
    .registerModule(
        SimpleModule()
            .addSerializer(BigInt::class.java, JacksonCustomizer.BigIntHexSerializer)
            .addDeserializer(BigInt::class.java, JacksonCustomizer.BigIntHexDeserializer)
    )

val objectMapper: ObjectMapper = jacksonObjectMapper().registerKotlinModule()
    .registerModule(
        SimpleModule()
            .addSerializer(BigInt::class.java, JacksonCustomizer.BigIntHexSerializer)
            .addDeserializer(BigInt::class.java, JacksonCustomizer.BigIntHexDeserializer)
    )