package org.exploit.keeper.extension.crypto

import org.exploit.keeper.exception.InvalidBase64Exception
import java.util.*

fun String.decodeBase64(): ByteArray {
    try {
        return Base64.getDecoder().decode(this)
    } catch (e: Exception) {
        throw InvalidBase64Exception()
    }
}

fun String.decodeBase64OrNull(): ByteArray? = try {
    this.decodeBase64()
} catch (e: Exception) {
    null
}

fun ByteArray.toBase64(): String {
    return Base64.getEncoder().encodeToString(this)
}