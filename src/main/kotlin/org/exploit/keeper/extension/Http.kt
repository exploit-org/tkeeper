package org.exploit.keeper.extension

import org.exploit.jettyx.model.HttpResponse
import reactor.core.publisher.Mono

fun <T> HttpResponse<T>.successOrThrow(): Mono<T> {
    if (status in 200..299 && exception == null) {
        return Mono.justOrEmpty(body)
    }

    if (exception != null)
        return Mono.error(exception)

    return Mono.error(IllegalStateException("Unexpected response: $status, $body"))
}