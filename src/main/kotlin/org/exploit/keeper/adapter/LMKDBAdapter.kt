package org.exploit.keeper.adapter

import io.quarkus.runtime.Startup
import jakarta.enterprise.inject.Produces
import jakarta.inject.Singleton
import org.exploit.keeper.config.KeeperConfig
import org.exploit.keeper.db.LMKDB
import org.exploit.keeper.service.seal.provider.SealProvider

@Startup
@Singleton
class LMKDBAdapter(
    private val config: KeeperConfig,
    private val provider: SealProvider
) {
    @Produces
    @Singleton
    @Startup
    fun lmkdb(): LMKDB {
        return LMKDB(config.databasePath()) { provider.keyOpsOrThrow() }
    }
}