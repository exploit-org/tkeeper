package org.exploit.keeper.api

import org.eclipse.jetty.http.HttpMethod
import org.exploit.jettyx.annotation.Body
import org.exploit.jettyx.annotation.HttpRequest
import org.exploit.jettyx.annotation.Query
import org.exploit.keeper.model.common.InitSession
import org.exploit.keeper.model.frost.ComputedZ
import org.exploit.keeper.model.frost.FrostOperationCommitment
import java.util.concurrent.CompletableFuture

interface FrostApi {
    @HttpRequest(method = HttpMethod.POST, path = "/v1/frost/init")
    fun init(@Body body: InitSession): CompletableFuture<Void>

    @HttpRequest(method = HttpMethod.POST, path = "/v1/frost/commitment")
    fun storeCommitment(
        @Query("sessionId") sessionId: String,
        @Body body: FrostOperationCommitment
    ): CompletableFuture<Void>

    @HttpRequest(method = HttpMethod.POST, path = "/v1/frost/commitment/broadcast")
    fun broadcast(
        @Query("sessionId") sessionId: String
    ): CompletableFuture<Void>

    @HttpRequest(method = HttpMethod.GET, path = "/v1/frost/signature/z")
    fun computeZ(
        @Query("sessionId") sessionId: String
    ): CompletableFuture<ComputedZ>

    @HttpRequest(method = HttpMethod.GET, path = "/v1/frost/abort")
    fun abort(
        @Query("sessionId") sessionId: String
    ): CompletableFuture<Void>
}