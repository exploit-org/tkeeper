package org.exploit.keeper.api

import org.eclipse.jetty.http.HttpMethod
import org.exploit.jettyx.annotation.Body
import org.exploit.jettyx.annotation.Header
import org.exploit.jettyx.annotation.HttpRequest
import org.exploit.jettyx.model.HttpResponse
import org.exploit.keeper.model.ecies.PartialDecryptRequest
import org.exploit.keeper.model.ecies.PartiallyDecrypted
import org.exploit.keeper.provider.MessagePackProvider
import java.util.concurrent.CompletableFuture

interface ECIESApi {
    @HttpRequest(path = "/v1/ecies/decrypt", method = HttpMethod.POST)
    fun decrypt(
        @Body decrypt: PartialDecryptRequest,
        @Header("Content-Type") contentType: String = MessagePackProvider.MSGPACK_MIME
    ): CompletableFuture<HttpResponse<PartiallyDecrypted>>
}