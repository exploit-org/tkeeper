package org.exploit.keeper.core.shell

import org.exploit.keeper.db.LMKDB
import org.exploit.keeper.extension.decodeBase64

class StoreCommand : ShellCommand {
    override val name = "store"
    override fun usage() = "store <keyId> <privateKey> <relatedPublicKey>"

    override fun execute(tokens: List<String>, db: LMKDB) {
        require(tokens.size == 4) { usage() }
        val keyId = tokens[1]
        val privateKey = tokens[2].decodeBase64()
        val publicKey = tokens[3].decodeBase64()

        db.private.save(keyId, privateKey)
        db.public.save(keyId, publicKey)

        println("\u001B[32mâœ” Stored key '$keyId'\u001B[0m")
    }
}