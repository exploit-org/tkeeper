package org.exploit.tkeeper.sdk.model;

import com.fasterxml.jackson.annotation.JsonInclude;
import com.fasterxml.jackson.annotation.JsonInclude.Include;
import com.fasterxml.jackson.annotation.JsonProperty;
import org.exploit.tkeeper.sdk.model.context.SignatureContext;

@JsonInclude(Include.NON_NULL)
public record Verify(
        @JsonProperty("keyId") String keyId,
        @JsonProperty("sigType") SignatureType sigType,
        @JsonProperty("data64") String data64,
        @JsonProperty("signature64") String signature64,
        @JsonProperty("context") SignatureContext context,
        @JsonProperty("generation") Integer generation,
        @JsonProperty("hash") Boolean hash,
        @JsonProperty("tweak") String tweak
) {
    public Verify(String keyId, SignatureType sigType, String data64, String signature64) {
        this(keyId, sigType, data64, signature64, null, null, null, null);
    }

    public Verify(String keyId, SignatureType sigType, String data64, String signature64, Boolean hash) {
        this(keyId, sigType, data64, signature64, null, null, hash, null);
    }

    public Verify(String keyId, SignatureType sigType, String data64, String signature64, SignatureContext context) {
        this(keyId, sigType, data64, signature64, context, null, null, null);
    }

    public Verify(String keyId, SignatureType sigType, String data64, String signature64, SignatureContext context, Integer generation) {
        this(keyId, sigType, data64, signature64, context, generation, null, null);
    }

    public static Verify of(String keyId, SignatureType sigType, String data64, String signature64) {
        return new Verify(keyId, sigType, data64, signature64, null, null, null, null);
    }

    public static Verify ofHashed(String keyId, SignatureType sigType, String data64, String signature64) {
        return new Verify(keyId, sigType, data64, signature64, null, null, true, null);
    }

    public static Verify of(String keyId, SignatureType sigType, String data64, String signature64, SignatureContext context) {
        return new Verify(keyId, sigType, data64, signature64, context, null, null, null);
    }

    public static Verify of(String keyId, SignatureType sigType, String data64, String signature64, SignatureContext context, Integer generation) {
        return new Verify(keyId, sigType, data64, signature64, context, generation, null, null);
    }

    public static Verify withTweak(String keyId, SignatureType sigType, String data64, String signature64, String tweak) {
        return new Verify(keyId, sigType, data64, signature64, null, null, null, tweak);
    }

    public static Verify withTweak(
            String keyId,
            SignatureType sigType,
            String data64,
            String signature64,
            SignatureContext context,
            Integer generation,
            String tweak
    ) {
        return new Verify(keyId, sigType, data64, signature64, context, generation, null, tweak);
    }

    public static Verify withContext(
            String keyId,
            SignatureType sigType,
            String data64,
            String signature64,
            SignatureContext context
    ) {
        return new Verify(keyId, sigType, data64, signature64, context, null, null, null);
    }

    public static Verify withContextHashed(
            String keyId,
            SignatureType sigType,
            String data64,
            String signature64,
            SignatureContext context
    ) {
        return new Verify(keyId, sigType, data64, signature64, context, null, true, null);
    }

    public static Verify full(
            String keyId,
            SignatureType sigType,
            String data64,
            String signature64,
            SignatureContext context,
            Integer generation,
            Boolean hash,
            String tweak
    ) {
        return new Verify(keyId, sigType, data64, signature64, context, generation, hash, tweak);
    }

    public Verify hashed() {
        return new Verify(keyId, sigType, data64, signature64, context, generation, true, tweak);
    }

    public Verify withTweak(String tweak) {
        return new Verify(keyId, sigType, data64, signature64, context, generation, hash, tweak);
    }

    public Verify withContext(SignatureContext context) {
        return new Verify(keyId, sigType, data64, signature64, context, generation, hash, tweak);
    }

    public Verify withGeneration(Integer generation) {
        return new Verify(keyId, sigType, data64, signature64, context, generation, hash, tweak);
    }
}
